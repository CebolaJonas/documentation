"use strict";(()=>{var jr=Object.create;var K=Object.defineProperty;var Br=Object.getOwnPropertyDescriptor;var Dr=Object.getOwnPropertyNames;var Mr=Object.getPrototypeOf,kr=Object.prototype.hasOwnProperty;var G=(r,a)=>()=>(r&&(a=r(r=0)),a);var B=(r,a)=>()=>(a||r((a={exports:{}}).exports,a),a.exports),de=(r,a)=>{for(var t in a)K(r,t,{get:a[t],enumerable:!0})},Xe=(r,a,t,l)=>{if(a&&typeof a=="object"||typeof a=="function")for(let c of Dr(a))!kr.call(r,c)&&c!==t&&K(r,c,{get:()=>a[c],enumerable:!(l=Br(a,c))||l.enumerable});return r};var Gr=(r,a,t)=>(t=r!=null?jr(Mr(r)):{},Xe(a||!r||!r.__esModule?K(t,"default",{value:r,enumerable:!0}):t,r)),ge=r=>Xe(K({},"__esModule",{value:!0}),r);var qe=B(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.getChooserHtml=void 0;var Hr=r=>{let a="<div>";return Object.keys(r).forEach(t=>{let l=r[t],c=l.currentValue||l.defaultValue;a+='<div class="markdoc-pref__container">',a+=`<div class="markdoc-pref__label">${l.displayName}</div>`,l.options.forEach(p=>{let v=p.id===c?"selected":"";a+=`<div class="markdoc-pref__pill ${v}" data-pref-id="${l.id}" data-option-id="${p.id}">${p.displayName}</div>`}),a+="</div>"}),a+="<hr />",a+="</div>",a};ee.getChooserHtml=Hr});var Je=B(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.PREF_OPTIONS_ID_REGEX=O.GLOBAL_PLACEHOLDER_REGEX=O.PLACEHOLDER_REGEX=O.SNAKE_CASE_REGEX=void 0;O.SNAKE_CASE_REGEX=/^[a-z0-9]+(_[a-z0-9]+)*$/;O.PLACEHOLDER_REGEX=/<([A-Z0-9_]+)>/;O.GLOBAL_PLACEHOLDER_REGEX=/<([A-Z0-9_]+)>/g;O.PREF_OPTIONS_ID_REGEX=/^([a-z0-9]+|<([A-Z0-9_]+)>)(_([a-z0-9]+)|_<([A-Z0-9_]+)>)*_options$/});var We=B(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.resolvePagePrefs=Ur;H.resolveMinifiedPagePrefs=Xr;H.resolveMinifiedPrefOptionsSource=ze;H.resolvePrefOptionsSource=Ze;var te=Je();function Ur(r){let a={};return r.pagePrefsConfig.forEach(t=>{let l=Ze({pagePrefConfig:t,valsByPrefId:r.valsByPrefId}),c=l.default_value||r.prefOptionsConfig[l.options_source].find(E=>E.default).id,p=r.prefOptionsConfig[l.options_source].map(E=>E.id),v=r.valsByPrefId[l.id];v&&!p.includes(v)&&(v=c);let _={id:l.id,displayName:l.display_name,defaultValue:c,currentValue:v,options:r.prefOptionsConfig[l.options_source].map(E=>({id:E.id,displayName:E.display_name}))};a[l.id]=_}),a}function Xr(r){let a={};return r.pagePrefsConfig.forEach(t=>{let l=ze({pagePrefConfig:t,valsByPrefId:r.valsByPrefId}),c=l.d||r.prefOptionsConfig[l.o].find(E=>E.d).i,p=r.prefOptionsConfig[l.o].map(E=>E.i),v=r.valsByPrefId[l.i];v&&!p.includes(v)&&(v=c);let _={id:l.i,displayName:l.n,defaultValue:c,currentValue:v,options:r.prefOptionsConfig[l.o].map(E=>({id:E.i,displayName:E.n}))};a[l.i]=_}),a}function ze(r){let a=Object.assign({},r.pagePrefConfig);return te.GLOBAL_PLACEHOLDER_REGEX.test(a.o)&&(a.o=a.o.replace(te.GLOBAL_PLACEHOLDER_REGEX,(t,l)=>r.valsByPrefId[l.toLowerCase()])),a}function Ze(r){let a=Object.assign({},r.pagePrefConfig);return te.GLOBAL_PLACEHOLDER_REGEX.test(a.options_source)&&(a.options_source=a.options_source.replace(te.GLOBAL_PLACEHOLDER_REGEX,(t,l)=>r.valsByPrefId[l.toLowerCase()])),a}});var Qe=B((jn,Ye)=>{"use strict";function qr(r,a){function t(){this.constructor=r}t.prototype=a.prototype,r.prototype=new t}function D(r,a,t,l){this.message=r,this.expected=a,this.found=t,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,D)}qr(D,Error);D.buildMessage=function(r,a,t){var l={literal:function(C){return'"'+p(C.text)+'"'},class:function(C){var y=C.parts.map(function(A){return Array.isArray(A)?v(A[0])+"-"+v(A[1]):v(A)});return"["+(C.inverted?"^":"")+y+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(C){return C.description},not:function(C){return"not "+_(C.expected)}};function c(C){return C.charCodeAt(0).toString(16).toUpperCase()}function p(C){return C.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(y){return"\\x0"+c(y)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(y){return"\\x"+c(y)})}function v(C){return C.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(y){return"\\x0"+c(y)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(y){return"\\x"+c(y)})}function _(C){return l[C.type](C)}function E(C){var y=C.map(_),A,V;if(y.sort(),y.length>0){for(A=1,V=1;A<y.length;A++)y[A-1]!==y[A]&&(y[V]=y[A],V++);y.length=V}switch(y.length){case 1:return y[0];case 2:return y[0]+" or "+y[1];default:return y.slice(0,-1).join(", ")+", or "+y[y.length-1]}}function T(C){return C?'"'+p(C)+'"':"end of input"}return"Expected "+E(r)+" but "+T(a)+" found."};function Jr(r,a){a=a!==void 0?a:{};var t={},l={Top:Oe},c=Oe,p="/",v=".",_="#",E="=",T="(",C=")",y=",",A="[",V="]",z="null",ye="true",Ce="false",dt="{",gt="}",ht=":",vt="-",ce='"',be="\\",mt="n",$t="r",yt="t",Ct=/^[$@]/,Z=/^[0-9]/,bt=/^[^\0-\x1F"\\]/,Ee=/^[a-zA-Z0-9_\-]/,Et=/^[ \n\t]/,Ae=F("/",!1),At=x("tag name"),_t=x("class"),Pt=x("id"),_e=F("=",!1),xt=F("(",!1),Ft=F(")",!1),W=F(",",!1),wt=x("variable"),Ot=x("null"),Tt=x("boolean"),Vt=F("[",!1),It=F("]",!1),Nt=F("{",!1),Rt=F("}",!1),St=F(":",!1),Lt=x("number"),jt=x("string"),Bt=x("identifier"),Dt=x("whitespace"),Mt=function(e){return{type:"variable",meta:{variable:e}}},kt=function(e){return{type:"annotation",meta:{attributes:e}}},Gt=function(e,n){return n},Ht=function(e,n,s,o){n&&(s=s||[],s.unshift({type:"attribute",name:"primary",value:n}));let[f,u]=o?["tag",0]:["tag_open",1];return{type:f,nesting:u,meta:{tag:e,attributes:s}}},Ut=function(e){return{type:"tag_close",nesting:-1,meta:{tag:e}}},Xt=function(e,n){return e?[e,...n]:[]},Pe=function(e){return e},qt=function(e){return e},Jt=function(e){return e},zt=function(e){return e},Zt=function(e){return{type:"class",name:e,value:!0}},Wt=function(e){return{type:"attribute",name:"id",value:e}},Yt=function(e,n){return{type:"attribute",name:e,value:n}},Qt=function(e,n,s){return n?[n,...s]:[]},Kt=function(e,n){let s={};for(let[o,{name:f,value:u}]of n.entries())s[f||o]=u;return new Sr(e,s)},xe=function(e){return e},er=function(e,n){return{name:e,value:n}},ue=function(e){return e},tr=function(e,n,s){return e==="@"?[n,...s]:new Rr([n,...s])},rr=function(){return null},nr=function(){return!0},ir=function(){return!1},sr=function(e,n){return[e,...n]},ar=function(e){return e||[]},or=function(e,n){return Object.assign(e,...n)},lr=function(e){return e||{}},fr=function(e,n){return e==="$$mdtype"?{}:{[e]:n}},cr=function(){return parseFloat(vr())},ur=function(e){return e.join("")},pr=function(){return`
`},dr=function(){return"\r"},gr=function(){return"	"},hr=function(e){return e},i=0,g=0,Y=[{line:1,column:1}],j=[],d=0,Q;if("startRule"in a){if(!(a.startRule in l))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');c=l[a.startRule]}function vr(){return r.substring(g,i)}function Pn(){return g}function xn(){return[g,i]}function Fn(){return X(g,i)}function wn(e,n){throw n=n!==void 0?n:X(g,i),we([x(e)],r.substring(g,i),n)}function On(e,n){throw n=n!==void 0?n:X(g,i),Cr(e,n)}function F(e,n){return{type:"literal",text:e,ignoreCase:n}}function Tn(e,n,s){return{type:"class",parts:e,inverted:n,ignoreCase:s}}function Vn(){return{type:"any"}}function mr(){return{type:"end"}}function x(e){return{type:"other",description:e}}function Fe(e){var n=Y[e],s;if(n)return n;for(s=e-1;!Y[s];)s--;for(n=Y[s],n={line:n.line,column:n.column};s<e;)r.charCodeAt(s)===10?(n.line++,n.column=1):n.column++,s++;return Y[e]=n,n}var $r=typeof a.filename=="string"&&a.filename.length>0;function X(e,n){var s={};$r&&(s.filename=a.filename);var o=Fe(e);s.start={offset:e,line:o.line,column:o.column};var f=Fe(n);return s.end={offset:n,line:f.line,column:f.column},s}function yr(){j.push({pos:i,variants:[]})}function $(e){var n=j[j.length-1];i<n.pos||(i>n.pos&&(n.pos=i,n.variants=[]),n.variants.push(e))}function In(e){var n=j.pop(),s=j[j.length-1],o=n.variants;s.pos===n.pos&&(e&&(o=o.map(function(f){return f.type==="not"?f.expected:{type:"not",expected:f}})),Array.prototype.push.apply(s.variants,o))}function Cr(e,n){return new D(e,null,null,n)}function we(e,n,s){return new D(D.buildMessage(e,n,s),e,n,s)}function br(){var e=j[0],n=e.pos;return we(e.variants,n<r.length?r.charAt(n):null,n<r.length?X(n,n+1):X(n,n))}function Oe(){var e,n=function(s){d===0&&$(s)};return e=Er(),e===t&&(e=Ar(),e===t&&(e=_r(),e===t&&(e=Pr()))),e}function Er(){var e,n,s=function(o){d===0&&$(o)};return e=i,n=Be(),n===t&&(n=Re()),n!==t&&(g=e,n=Mt(n)),e=n,e}function Ar(){var e,n,s,o,f=function(u){d===0&&$(u)};if(e=i,n=Ve(),n!==t){for(s=[],o=m();o!==t;)s.push(o),o=m();g=e,e=kt(n)}else i=e,e=t;return e}function _r(){var e,n,s,o,f,u,h,P=function(w){d===0&&$(w)};if(e=i,n=Te(),n!==t){for(s=[],o=m();o!==t;)s.push(o),o=m();for(o=i,f=k(),f!==t?(u=m(),u===t&&(u=null),g=o,o=Gt(n,f)):(i=o,o=t),o===t&&(o=null),f=Ve(),f===t&&(f=null),u=[],h=m();h!==t;)u.push(h),h=m();P(Ae),r.charCodeAt(i)===47?(h=p,i++):h=t,h===t&&(h=null),g=e,e=Ht(n,o,f,h)}else i=e,e=t;return e}function Pr(){var e,n,s,o=function(f){d===0&&$(f)};return e=i,o(Ae),r.charCodeAt(i)===47?(n=p,i++):n=t,n!==t?(s=Te(),s!==t?(g=e,e=Ut(s)):(i=e,e=t)):(i=e,e=t),e}function Te(){var e,n=function(s){d===0&&$(s)};return n(At),d++,e=I(),d--,e}function Ve(){var e,n,s,o,f=function(u){d===0&&$(u)};if(e=i,n=Ne(),n!==t){for(s=[],o=Ie();o!==t;)s.push(o),o=Ie();g=e,e=Xt(n,s)}else i=e,e=t;return e}function Ie(){var e,n,s,o=function(f){d===0&&$(f)};if(e=i,n=[],s=m(),s!==t)for(;s!==t;)n.push(s),s=m();else n=t;return n!==t?(s=Ne(),s!==t?(g=e,e=Pe(s)):(i=e,e=t)):(i=e,e=t),e}function Ne(){var e,n,s=function(o){d===0&&$(o)};return e=i,n=Fr(),n!==t&&(g=e,n=qt(n)),e=n,e===t&&(e=i,n=xr(),n!==t&&(g=e,n=Jt(n)),e=n,e===t&&(e=i,n=wr(),n!==t&&(g=e,n=zt(n)),e=n)),e}function xr(){var e,n,s,o=function(f){d===0&&$(f)};return o(_t),d++,e=i,r.charCodeAt(i)===46?(n=v,i++):n=t,n!==t?(s=I(),s!==t?(g=e,e=Zt(s)):(i=e,e=t)):(i=e,e=t),d--,e}function Fr(){var e,n,s,o=function(f){d===0&&$(f)};return o(Pt),d++,e=i,r.charCodeAt(i)===35?(n=_,i++):n=t,n!==t?(s=I(),s!==t?(g=e,e=Wt(s)):(i=e,e=t)):(i=e,e=t),d--,e}function wr(){var e,n,s,o,f=function(u){d===0&&$(u)};return e=i,n=I(),n!==t?(f(_e),r.charCodeAt(i)===61?(s=E,i++):s=t,s!==t?(o=k(),o!==t?(g=e,e=Yt(n,o)):(i=e,e=t)):(i=e,e=t)):(i=e,e=t),e}function Re(){var e,n,s,o,f,u,h,P,w=function(Lr){d===0&&$(Lr)};if(e=i,n=I(),n!==t)if(w(xt),r.charCodeAt(i)===40?(s=T,i++):s=t,s!==t){for(o=[],f=m();f!==t;)o.push(f),f=m();for(f=i,u=Se(),u===t&&(u=null),h=[],P=Le();P!==t;)h.push(P),P=Le();g=f,f=Qt(n,u,h),w(Ft),r.charCodeAt(i)===41?(u=C,i++):u=t,u!==t?(g=e,e=Kt(n,f)):(i=e,e=t)}else i=e,e=t;else i=e,e=t;return e}function Se(){var e,n,s,o,f=function(u){d===0&&$(u)};return e=i,n=i,s=I(),s!==t?(f(_e),r.charCodeAt(i)===61?(o=E,i++):o=t,o!==t?(g=n,n=xe(s)):(i=n,n=t)):(i=n,n=t),n===t&&(n=null),s=k(),s!==t?(g=e,e=er(n,s)):(i=e,e=t),e}function Le(){var e,n,s,o,f,u=function(h){d===0&&$(h)};for(e=i,n=[],s=m();s!==t;)n.push(s),s=m();if(u(W),r.charCodeAt(i)===44?(s=y,i++):s=t,s!==t){for(o=[],f=m();f!==t;)o.push(f),f=m();f=Se(),f!==t?(g=e,e=ue(f)):(i=e,e=t)}else i=e,e=t;return e}function je(){var e,n,s,o=function(f){d===0&&$(f)};for(e=i,n=[],s=m();s!==t;)n.push(s),s=m();return o(W),r.charCodeAt(i)===44?(s=y,i++):s=t,s!==t?(n=[n,s],e=n):(i=e,e=t),e===t&&(e=null),e}function Be(){var e,n,s,o,f,u=function(h){d===0&&$(h)};if(u(wt),d++,e=i,Ct.test(r.charAt(i))?(n=r.charAt(i),i++):n=t,n!==t)if(s=I(),s!==t){for(o=[],f=De();f!==t;)o.push(f),f=De();g=e,e=tr(n,s,o)}else i=e,e=t;else i=e,e=t;return d--,e}function De(){var e,n,s,o,f=function(u){d===0&&$(u)};return e=i,r.charCodeAt(i)===46?(n=v,i++):n=t,n!==t?(s=I(),s!==t?(g=e,e=xe(s)):(i=e,e=t)):(i=e,e=t),e===t&&(e=i,r.charCodeAt(i)===91?(n=A,i++):n=t,n!==t?(s=He(),s===t&&(s=pe()),s!==t?(r.charCodeAt(i)===93?(o=V,i++):o=t,o!==t?(g=e,e=ue(s)):(i=e,e=t)):(i=e,e=t)):(i=e,e=t)),e}function k(){var e,n=function(s){d===0&&$(s)};return e=Or(),e===t&&(e=Tr(),e===t&&(e=pe(),e===t&&(e=He(),e===t&&(e=Vr(),e===t&&(e=Ir(),e===t&&(e=Re(),e===t&&(e=Be()))))))),e}function Or(){var e,n,s=function(o){d===0&&$(o)};return s(Ot),d++,e=i,r.substr(i,4)===z?(n=z,i+=4):n=t,n!==t&&(g=e,n=rr()),e=n,d--,e}function Tr(){var e,n,s=function(o){d===0&&$(o)};return s(Tt),d++,e=i,r.substr(i,4)===ye?(n=ye,i+=4):n=t,n!==t&&(g=e,n=nr()),e=n,e===t&&(e=i,r.substr(i,5)===Ce?(n=Ce,i+=5):n=t,n!==t&&(g=e,n=ir()),e=n),d--,e}function Vr(){var e,n,s,o,f,u,h,P=function(w){d===0&&$(w)};if(e=i,P(Vt),r.charCodeAt(i)===91?(n=A,i++):n=t,n!==t){for(s=[],o=m();o!==t;)s.push(o),o=m();if(o=i,f=k(),f!==t){for(u=[],h=Me();h!==t;)u.push(h),h=Me();h=je(),g=o,o=sr(f,u)}else i=o,o=t;for(o===t&&(o=null),f=[],u=m();u!==t;)f.push(u),u=m();P(It),r.charCodeAt(i)===93?(u=V,i++):u=t,u!==t?(g=e,e=ar(o)):(i=e,e=t)}else i=e,e=t;return e}function Me(){var e,n,s,o,f,u=function(h){d===0&&$(h)};for(e=i,n=[],s=m();s!==t;)n.push(s),s=m();if(u(W),r.charCodeAt(i)===44?(s=y,i++):s=t,s!==t){for(o=[],f=m();f!==t;)o.push(f),f=m();f=k(),f!==t?(g=e,e=ue(f)):(i=e,e=t)}else i=e,e=t;return e}function Ir(){var e,n,s,o,f,u,h,P=function(w){d===0&&$(w)};if(e=i,P(Nt),r.charCodeAt(i)===123?(n=dt,i++):n=t,n!==t){for(s=[],o=m();o!==t;)s.push(o),o=m();if(o=i,f=Ge(),f!==t){for(u=[],h=ke();h!==t;)u.push(h),h=ke();h=je(),g=o,o=or(f,u)}else i=o,o=t;for(o===t&&(o=null),f=[],u=m();u!==t;)f.push(u),u=m();P(Rt),r.charCodeAt(i)===125?(u=gt,i++):u=t,u!==t?(g=e,e=lr(o)):(i=e,e=t)}else i=e,e=t;return e}function ke(){var e,n,s,o,f,u=function(h){d===0&&$(h)};for(e=i,n=[],s=m();s!==t;)n.push(s),s=m();if(u(W),r.charCodeAt(i)===44?(s=y,i++):s=t,s!==t){for(o=[],f=m();f!==t;)o.push(f),f=m();f=Ge(),f!==t?(g=e,e=Pe(f)):(i=e,e=t)}else i=e,e=t;return e}function Ge(){var e,n,s,o,f,u=function(h){d===0&&$(h)};if(e=i,n=I(),n===t&&(n=pe()),n!==t)if(u(St),r.charCodeAt(i)===58?(s=ht,i++):s=t,s!==t){for(o=[],f=m();f!==t;)o.push(f),f=m();f=k(),f!==t?(g=e,e=fr(n,f)):(i=e,e=t)}else i=e,e=t;else i=e,e=t;return e}function He(){var e,n,s,o,f,u,h,P=function(w){d===0&&$(w)};if(P(Lt),d++,e=i,r.charCodeAt(i)===45?(n=vt,i++):n=t,n===t&&(n=null),s=[],Z.test(r.charAt(i))?(o=r.charAt(i),i++):o=t,o!==t)for(;o!==t;)s.push(o),Z.test(r.charAt(i))?(o=r.charAt(i),i++):o=t;else s=t;if(s!==t){if(o=i,r.charCodeAt(i)===46?(f=v,i++):f=t,f!==t){if(u=[],Z.test(r.charAt(i))?(h=r.charAt(i),i++):h=t,h!==t)for(;h!==t;)u.push(h),Z.test(r.charAt(i))?(h=r.charAt(i),i++):h=t;else u=t;u!==t?(f=[f,u],o=f):(i=o,o=t)}else i=o,o=t;o===t&&(o=null),g=e,e=cr()}else i=e,e=t;return d--,e}function pe(){var e,n,s,o,f=function(u){d===0&&$(u)};if(f(jt),d++,e=i,r.charCodeAt(i)===34?(n=ce,i++):n=t,n!==t){for(s=[],o=Ue();o!==t;)s.push(o),o=Ue();r.charCodeAt(i)===34?(o=ce,i++):o=t,o!==t?(g=e,e=ur(s)):(i=e,e=t)}else i=e,e=t;return d--,e}function Ue(){var e,n=function(s){d===0&&$(s)};return bt.test(r.charAt(i))?(e=r.charAt(i),i++):e=t,e===t&&(e=Nr()),e}function Nr(){var e,n,s,o,f=function(u){d===0&&$(u)};return e=i,r.charCodeAt(i)===92?(n=be,i++):n=t,n!==t?(r.charCodeAt(i)===34?(s=ce,i++):s=t,s===t&&(r.charCodeAt(i)===92?(s=be,i++):s=t,s===t&&(s=i,r.charCodeAt(i)===110?(o=mt,i++):o=t,o!==t&&(g=s,o=pr()),s=o,s===t&&(s=i,r.charCodeAt(i)===114?(o=$t,i++):o=t,o!==t&&(g=s,o=dr()),s=o,s===t&&(s=i,r.charCodeAt(i)===116?(o=yt,i++):o=t,o!==t&&(g=s,o=gr()),s=o)))),s!==t?(g=e,e=hr(s)):(i=e,e=t)):(i=e,e=t),e}function I(){var e,n,s,o=function(f){d===0&&$(f)};if(o(Bt),d++,e=i,n=[],Ee.test(r.charAt(i))?(s=r.charAt(i),i++):s=t,s!==t)for(;s!==t;)n.push(s),Ee.test(r.charAt(i))?(s=r.charAt(i),i++):s=t;else n=t;return n!==t?e=r.substring(e,i):e=n,d--,e}function m(){var e,n=function(s){d===0&&$(s)};return n(Dt),d++,Et.test(r.charAt(i))?(e=r.charAt(i),i++):e=t,d--,e}let{Variable:Rr,Function:Sr}=a;if(yr(),Q=c(),Q!==t&&i===r.length)return Q;throw Q!==t&&i<r.length&&$(mr()),br()}Ye.exports={SyntaxError:D,parse:Jr}});var q,Ke=G(()=>{"use strict";q=class{constructor(a=[]){this.$$mdtype="Variable";this.path=a}resolve({variables:a}={}){if(a instanceof Function)return a(this.path);let t=this.path.reduce((l={},c)=>l[c],a);return{$$mdtype:"Variable",path:this.path,value:t}}}});function zr(r){return!!r?.$$mdtype}function re(r,a={}){if(r==null||typeof r!="object")return r;if(Array.isArray(r))return r.map(l=>re(l,a));if(zr(r)&&r?.resolve instanceof Function)return r.resolve(a);if(Object.getPrototypeOf(r)!==Object.prototype)return r;let t={};for(let[l,c]of Object.entries(r))t[l]=re(c,a);return t}var et=G(()=>{"use strict"});var J,tt=G(()=>{"use strict";et();J=class{constructor(a,t){this.$$mdtype="Function";this.name=a,this.parameters=t}resolve(a={}){let t=a?.functions?.[this.name];if(!t)return null;let l=re(this.parameters,a);return t.transform?.(l,a)}}});var it={};de(it,{CLOSE:()=>ie,IDENTIFIER_REGEX:()=>rt,OPEN:()=>ne,buildTag:()=>Qr,findTagEnd:()=>nt,isClientFunction:()=>tn,isClientVariable:()=>en,isIdentifier:()=>Zr,isPromise:()=>he,isTag:()=>Kr,parseTags:()=>Yr});function Zr(r){return typeof r=="string"&&rt.test(r)}function he(r){return r&&typeof r=="object"&&typeof r.then=="function"}function nt(r,a=0){let t=0;for(let l=a;l<r.length;l++){let c=r[l];switch(t){case 1:switch(c){case'"':t=0;break;case"\\":t=2;break}break;case 2:t=1;break;case 0:if(c==='"')t=1;else if(r.startsWith(ie,l))return l}}return null}function Wr(r,a,t){try{return(0,se.parse)(r,{Variable:q,Function:J})}catch(l){if(!(l instanceof se.SyntaxError))throw l;let{message:c,location:{start:p,end:v}}=l,_={start:{line:a,character:p.offset+t},end:{line:a+1,character:v.offset+t}};return{type:"error",meta:{error:{message:c,location:_}}}}}function Yr(r,a=0){let t=a+1,l=[],c=0;for(let p=0;p<r.length;p++){if(r[p]===`
`){t++;continue}if(!r.startsWith(ne,p))continue;let v=nt(r,p);if(v==null){p=p+ne.length;continue}let _=r.slice(p,v+ie.length),E=r.slice(p+ne.length,v),T=r.lastIndexOf(`
`,p),C=r.indexOf(`
`,v),y=r.slice(T,C),A=Wr(E.trim(),t,p-T),V=y.trim()===_?T:p,z=r.slice(c,V);l.push({type:"text",start:c,end:p-1,content:z}),l.push({map:[t,t+1],position:{start:p-T,end:p-T+_.length},start:p,end:p+_.length-1,info:_,...A}),c=v+ie.length,p=c-1}return l.push({type:"text",start:c,end:r.length-1,content:r.slice(c)}),l}function Qr(r="div",a={},t=[]){return{$$mdtype:"Tag",name:r,attributes:a,children:t}}function Kr(r){return r?.$$mdtype==="Tag"}function en(r){return r?.$$mdtype==="Variable"}function tn(r){return r?.$$mdtype==="Function"}var se,ne,ie,rt,ve=G(()=>{"use strict";se=Gr(Qe());Ke();tt();ne="{%",ie="%}",rt=/^[a-zA-Z0-9_-]+$/});var st={};de(st,{tagElse:()=>nn,tagIf:()=>rn,truthy:()=>M});function M(r){return typeof r=="object"&&"value"in r?r.value!==!1&&r.value!==void 0&&r.value!==null:r!==!1&&r!==void 0&&r!==null}var rn,nn,me=G(()=>{"use strict";ve();rn={attributes:{primary:{type:Object,render:!0}},transform(r,a){let t=c=>({$$mdtype:"Tag",name:r.attributes.inline?"span":"div",if:r.attributes.primary,attributes:{display:M(r.attributes.primary)?"true":"false"},children:c}),l=r.children.flatMap(c=>c.transform(a));return l.some(he)?Promise.all(l).then(c=>[t(c.flat())]):[t(l)]}},nn={selfClosing:!0,attributes:{primary:{type:Object,render:!1}}}});var at={};de(at,{default:()=>un});var U,sn,an,on,ln,fn,cn,un,ot=G(()=>{"use strict";me();U=class r{static{this.ref=0}static generateRef(){return`${r.ref++}`}},sn={transform(r){return{$$mdtype:"Function",name:"and",value:Object.values(r).every(t=>typeof t=="object"?M(t.value):M(t)),parameters:r,ref:U.generateRef()}}},an={transform(r){return{$$mdtype:"Function",name:"or",value:Object.values(r).find(t=>M(t.value))!==void 0,parameters:r,ref:U.generateRef()}}},on={parameters:{0:{required:!0}},transform(r){return{$$mdtype:"Function",name:"not",value:!M(r[0].value),parameters:r,ref:U.generateRef()}}},ln={transform(r){let a=Object.values(r).map(l=>typeof l=="object"?l.value:l);return{$$mdtype:"Function",name:"equals",value:a.every(l=>l===a[0]),parameters:r,ref:U.generateRef()}}},fn={transform(r){return typeof r[0]=="object"?JSON.stringify(r[0].value,null,2):JSON.stringify(r[0],null,2)}},cn={transform(r){let a;return Object.values(r).forEach(t=>{a===void 0&&(typeof t=="object"?a=t.value:a=t)}),{$$mdtype:"Function",name:"default",value:a,parameters:r}}},un={and:sn,or:an,not:on,equals:ln,default:cn,debug:fn}});var ft=B(R=>{"use strict";var pn=R&&R.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(R,"__esModule",{value:!0});R.reresolve=$e;R.reresolveIfNode=lt;R.reresolveFunctionNode=ae;R.reresolveVariableNode=oe;var dn=pn((ot(),ge(at))),gn=(me(),ge(st)),N=(ve(),ge(it));function $e(r,a){if(!a)throw new Error("Config is required to refresh client renderable tree nodes.");if(r===null||typeof r!="object")return r;if(Array.isArray(r)){for(let t of r)"$$mdtype"in t&&$e(t,a);return r}return(0,N.isClientVariable)(r)?(r=oe(r,a),r):(0,N.isClientFunction)(r)?(r=ae(r,a),r):(0,N.isTag)(r)?(r.children=r.children.map(t=>(0,N.isTag)(t)||(0,N.isClientVariable)(t)||(0,N.isClientFunction)(t)?$e(t,a):t),"if"in r&&(r=lt(r,a)),r):r}function lt(r,a){let t=r.if;return(0,N.isClientVariable)(t)?t=oe(t,a):(0,N.isClientFunction)(t)&&(t=ae(t,a)),(0,gn.truthy)(t)?r.attributes.display="true":r.attributes.display="false",r}function ae(r,a){for(let[c,p]of Object.entries(r.parameters))p.$$mdtype==="Variable"?r.parameters[c]=oe(p,a):p.$$mdtype==="Function"&&(r.parameters[c]=ae(p,a));let t=dn.default[r.name];if(!t)throw new Error(`Unknown function: ${r.name}`);if(!t.transform)throw new Error(`Function ${r.name} has no transform method`);let l=t.transform(r.parameters,a).value;return r.value=l,r}function oe(r,a){if(a.variables===void 0)return{$$mdtype:"Variable",path:r.path,value:void 0};if(a.variables instanceof Function)return{$$mdtype:"Variable",path:r.path,value:a.variables(r.path)};let t;for(let l of r.path)t=t?t[l]:a.variables[l];return r.value=t,r}});var ct=B(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.expandClientFunction=b.minifyClientFunction=b.minifyClientVariable=b.expandClientVariable=b.CLIENT_FUNCTION_MINIFY_MAP=b.CLIENT_FUNCTION_EXPAND_MAP=void 0;b.CLIENT_FUNCTION_EXPAND_MAP={F:"Function",a:"and",o:"or",e:"equals",n:"not",def:"default",deb:"debug"};b.CLIENT_FUNCTION_MINIFY_MAP={Function:"F",and:"a",or:"o",equals:"e",not:"n",default:"def",debug:"deb"};var hn=r=>{let a=JSON.parse(JSON.stringify(r));return{$$mdtype:"Variable",path:a.p,value:a.v}};b.expandClientVariable=hn;var vn=r=>{let a=JSON.parse(JSON.stringify(r));return{m:"V",p:a.path,v:a.value}};b.minifyClientVariable=vn;var mn=r=>{let a=JSON.parse(JSON.stringify(r));return Object.keys(a.parameters).forEach(t=>{let l=a.parameters[t];typeof l=="object"&&"$$mdtype"in l&&l.$$mdtype==="Function"?a.parameters[t]=(0,b.minifyClientFunction)(l):typeof l=="object"&&"$$mdtype"in l&&l.$$mdtype==="Variable"&&(a.parameters[t]=(0,b.minifyClientVariable)(l))}),{m:b.CLIENT_FUNCTION_MINIFY_MAP[a.$$mdtype],n:b.CLIENT_FUNCTION_MINIFY_MAP[a.name],p:a.parameters,v:a.value,r:a.ref}};b.minifyClientFunction=mn;var $n=r=>{let a=JSON.parse(JSON.stringify(r));return Object.keys(a.p).forEach(t=>{let l=a.p[t];typeof l=="object"&&"m"in l&&l.m==="F"?a.p[t]=(0,b.expandClientFunction)(l):typeof l=="object"&&"m"in l&&l.m==="V"&&(a.p[t]=(0,b.expandClientVariable)(l))}),{$$mdtype:b.CLIENT_FUNCTION_EXPAND_MAP[a.m],name:b.CLIENT_FUNCTION_EXPAND_MAP[a.n],parameters:a.p,value:a.v,ref:a.r}};b.expandClientFunction=$n});var pt=B(L=>{"use strict";var ut=L&&L.__classPrivateFieldGet||function(r,a,t,l){if(t==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?r!==a||!l:!a.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?l:t==="a"?l.call(r):l?l.value:a.get(r)},yn=L&&L.__classPrivateFieldSet||function(r,a,t,l,c){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!c)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?r!==a||!c:!a.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?c.call(r,t):c?c.value=t:a.set(r,t),t},S,le;Object.defineProperty(L,"__esModule",{value:!0});L.ClientRenderer=void 0;var Cn=qe(),bn=We(),En=ft(),An=ct(),fe=class{constructor(){this.selectedValsByPrefId={},this.ifFunctionsByRef={}}static get instance(){return ut(S,S,"f",le)||yn(S,S,new S,"f",le),ut(S,S,"f",le)}getSelectedValsFromUrl(){let t=new URL(window.location.href).searchParams,l={};return t.forEach((c,p)=>{l[p]=c}),console.log("Selected vals from the URL:",l),l}syncUrlWithSelectedVals(){let a=new URL(window.location.href),t=a.searchParams;Object.keys(this.selectedValsByPrefId).sort().forEach(c=>{t.set(c,this.selectedValsByPrefId[c])}),window.history.replaceState({},"",a.toString())}handlePrefSelectionChange(a){let t=a.target;if(!(t instanceof Element))return;let l=t.getAttribute("data-pref-id");if(!l)return;let c=t.getAttribute("data-option-id");c&&(this.selectedValsByPrefId[l]=c,this.rerenderChooser(),this.rerenderPageContent(),this.populateRightNav(),this.syncUrlWithSelectedVals())}elementIsHidden(a){let t=a;for(;t;){if(t.classList.contains("markdoc__hidden"))return!0;t=t.parentElement}}populateRightNav(){let a="<ul>",t=Array.from(document.querySelectorAll("#mainContent h2, #mainContent h3, #mainContent h4, #mainContent h5, #mainContent h6")),l=2;t.forEach(p=>{if(this.elementIsHidden(p))return;let v=parseInt(p.tagName[1]);v>l?a+="<ul>":v<l&&(a+="</ul>"),l=v,console.log(p),a+=`<li><a href="#${p.id}">${p.textContent}</a></li>`}),a+="</ul>";let c=document.getElementById("TableOfContents");if(!c)throw new Error('Cannot find right nav element with id "TableOfContents"');c.innerHTML=a}rerenderPageContent(){let a={};Object.keys(this.ifFunctionsByRef).forEach(l=>{let c=this.ifFunctionsByRef[l],p=c.value,v=(0,En.reresolveFunctionNode)(c,{variables:this.selectedValsByPrefId});this.ifFunctionsByRef[l]=v,p!==v.value&&(a[l]=v.value)});let t=document.getElementsByClassName("markdoc__toggleable");for(let l=0;l<t.length;l++){let c=t[l],p=c.getAttribute("data-if");if(!p)throw new Error("No ref found on toggleable element");a[p]!==void 0&&(a[p]?c.classList.remove("markdoc__hidden"):c.classList.add("markdoc__hidden"))}}addChooserEventListeners(){let a=document.getElementsByClassName("markdoc-pref__pill");for(let t=0;t<a.length;t++)a[t].addEventListener("click",l=>this.handlePrefSelectionChange(l))}initialize(a){this.prefOptionsConfig=a.prefOptionsConfig,this.pagePrefsConfig=a.pagePrefsConfig,this.chooserElement=a.chooserElement,this.selectedValsByPrefId=a.selectedValsByPrefId||{},this.ifFunctionsByRef={},Object.keys(a.ifFunctionsByRef).forEach(l=>{this.ifFunctionsByRef[l]=(0,An.expandClientFunction)(a.ifFunctionsByRef[l])});let t=document.getElementById("markdoc-chooser");if(t)this.chooserElement=t;else throw new Error('Cannot find chooser element with id "markdoc-chooser"');this.getSelectedValsFromUrl(),this.addChooserEventListeners(),this.syncUrlWithSelectedVals(),document.addEventListener("DOMContentLoaded",()=>{this.populateRightNav()})}rerenderChooser(){if(!this.pagePrefsConfig||!this.prefOptionsConfig||!this.chooserElement)throw new Error("Cannot rerender chooser without pagePrefsConfig, prefOptionsConfig, and chooserElement");let a=(0,bn.resolveMinifiedPagePrefs)({pagePrefsConfig:this.pagePrefsConfig,prefOptionsConfig:this.prefOptionsConfig,valsByPrefId:this.selectedValsByPrefId});Object.keys(a).forEach(l=>{let c=a[l];this.selectedValsByPrefId[c.id]=c.currentValue});let t=(0,Cn.getChooserHtml)(a);this.chooserElement.innerHTML=t,this.addChooserEventListeners()}};L.ClientRenderer=fe;S=fe;le={value:void 0}});var _n=pt().ClientRenderer;window.clientRenderer=_n.instance;})();
